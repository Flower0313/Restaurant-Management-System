@{
    ViewBag.Title = "Shop";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/css/main.css" rel="stylesheet" />
<script src="~/Content/js/my_scrollbar.js"></script>
<script src="~/Content/js/main.js"></script>
<style type="text/css">
    html {
        overflow-y: scroll;
    }
    .mask {
        position: absolute;
        top: 0px;
        filter: alpha(opacity=60);
        background-color: #777;
        z-index: 1002;
        left: 0px;
        opacity: 0.5;
        -moz-opacity: 0.5;
    }

    #listpanel a i {
        margin-right: 8px;
    }

    #submitbtn {
        background-color: white;
        border: 1px solid #555555;
        color: #555555;
        width: 20%;
    }

        #submitbtn:hover {
            transition: 0.4s;
            background-color: #555555;
            color: white;
        }

    .Attopic {
        display: block;
        left: 56px;
        position: absolute;
        top: 68px;
        z-index: 999;
        background: #fff;
        border: 1px solid #ccc;
        padding: 2px;
        width: 180px;
        height: 100px;
        overflow-x: hidden;
        overflow-y: hidden;
    }

    .box {
        height: 400px;
        border: 1px solid #ccc;
        padding: 0;
        overflow: hidden;
    }

        .box p {
            margin: 0;
            padding: 0;
            line-height: 40px;
        }

    #citya li a {
        color: black;
        font-size: 1.0vw;
        cursor: pointer;
    }

    #lunbo {
        width: 85%;
        height: 200px;
        margin: 5px auto;
    }
</style>

<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header" style="font-size: 1.5vw; font-family: 微软雅黑;">门面查询</h1>
        </div>
    </div>
</div>
<!--城市显示-->
<div class="row">
    <!-左边显示列表-->
            <div class='box col-lg-2' id='wrapper1'>
                <div class="scroll col-lg-12">
                    @*<label>湖南</label>*@
                    <ul class="nav nav-second-level" id="citya">
                    </ul>
                </div>
            </div>
    <!--右边城市显示-->
    <div class="col-lg-9" style="margin-left: 10px;">
        <div class="col-lg-12" style="height: 30px; text-align: center">
            <label style="font-size: 1.0vw;">店铺展示</label>
        </div>
        <!--轮播开始-->
        <div class="trent-slider" id="lunbo">
            <div>
                <div class="t-slide current-t-slide" id="first">
                    <img src="/Content/images/tushow.jpg" />
                </div>
            </div>


            <!--图片结束-->
            <div class="t-slider-controls">
                <div class="arrow right-arrow">
                    <div class="arrow-container">
                        <div class="arrow-icon"><i class="fa fa-chevron-right" aria-hidden="true"></i></div>
                    </div>
                </div>
                <div class="arrow left-arrow">
                    <div class="arrow-container">
                        <div class="arrow-icon"><i class="fa fa-chevron-left" aria-hidden="true"></i></div>
                    </div>
                </div>
                <div class="t-load-bar">
                    <div class="inner-load-bar"></div>
                </div>
                <div class="t-dots-container">
                    <div class="t-slide-dots-wrap">
                        <div class="t-slide-dots">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--轮播结束-->
        <div class="panel panel-default panel-primary">
            <div class="panel-heading">
                店铺信息
                       
            </div>
            <!-- /.panel-heading -->
            <div class="panel-body">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#home" data-toggle="tab">基本信息</a>
                    </li>
                    <li><a href="#profile" data-toggle="tab">负责人信息</a>
                    </li>
                    <li><a href="#messages" data-toggle="tab">店铺简介</a>
                    </li>
                    <li><a href="#settings" data-toggle="tab">员工介绍</a>
                    </li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content">
                    <div class="tab-pane fade in active" id="home" style="margin: 5px 0px">
                        <div class="col-lg-12">
                            <h5 class="col-lg-4">名称：<label id="cityname"></label></h5>
                            <h5 class="col-lg-4">省份：<label id="citypre"></label></h5>
                            <h5 class="col-lg-4">城市：<label id="citycity"></label></h5>
                            <h5 class="col-lg-4">年营业额:<label id="money"></label>元</h5>
                            <h5 class="col-lg-4">店铺代码：<label id="cityID"></label></h5>
                            <h5 class="col-lg-4">员工数：<label id="person"></label>人</h5>
                            <h5 class="col-lg-4">运营费：<label id="tax"></label>(元/年)</h5>
                            <h5 class="col-lg-4">缴费情况：<label id="taxstate"></label></h5>
                            <h5 class="col-lg-4">注册日期：<label id="begin"></label></h5>
                            <h5 class="col-lg-12">店铺状态：<label id="state"></label></h5>
                            <h5 class="col-lg-12">店铺地址：<label id="cityaddress"></label></h5>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="profile" style="margin: 5px 0px">
                        <img src="/Content/images/null.jpg" id="boospic" style="width: 12%" />
                        <!--店主信息-->
                        <div class="col-lg-10 pull-right">
                            <h5 class="col-lg-4">姓名：<label id="bossname"></label></h5>
                            <h5 class="col-lg-4">性别：<label id="bosssex"></label></h5>
                            <h5 class="col-lg-4">年龄：<label id="bossage"></label></h5>
                            <h5 class="col-lg-4">联系电话:<label id="bossnumber"></label></h5>
                            <h5 class="col-lg-4">身份证：<label id="bossidcard"></label></h5>
                            <h5 class="col-lg-4">状态：<label id="bossstate"></label></h5>
                            <h5 class="col-lg-12">座右铭：<label id="bosstxt"></label></h5>
                        </div>
                    </div>
                    <div class="tab-pane fade" id="messages" style="margin: 5px 0px">
                        <!--图片显示区域-->
                        <div class="col-lg-12" id="picdiv">
                        </div>
                        <label class="col-lg-12" id="shoptxt">
                        </label>
                    </div>
                    <div class="tab-pane fade table-responsive" id="settings" style="overflow-x: auto; overflow-y: auto; height: 200px; margin: 5px 0px">
                        <!--员工显示-->
                        <table class="table table-striped" id="tablediv">
                            <tr id="trr">
                                <td>编号</td>
                                <td>姓名</td>
                                <td>部门</td>
                                <td>性别</td>
                                <td>状态</td>
                                <td>年龄</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            <!-- /.panel-body -->
        </div>
    </div>
</div>

<script>
    var name = "";
    $(function () {
        shopname();
        direction();
        lunbo();
        //城市点击绑定右边事件
        $("#citya").on('click', "li a", function () {
            name = $(this).text();//获取城市名
            //消除图片轮播
            $("#first").siblings().empty();
            Base();//显示店铺信息
            Base2();//显示负责人信息
            Base4();//显示员工
        });

    })

    function direction() {
        $("#address").append("<li><a href='forms.html?name=长沙'>长沙</a></li>");
    }
    //轮播
    function lunbo() {
        var oMyBar1 = new MyScrollBar({
            selId: 'wrapper1',
            bgColor: 'white',
            barColor: '#337ab7',
            //enterColor: 'red',
            enterShow: false,
            borderRadius: 2,
        });
    }

    function shopname() {
        var idd = document.location.search.substr(6).toString();
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: "/Index/shopname",
            data: { 'name': idd },
            success: function (data) {
                $.each(data, function (i, item) {
                    $("#citya").append("<li><a>" + item.Shop_name + "</a></li>");
                });
            }
        })
    }

    //获取城市基本信息
    function Base() {
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: "/Index/Base",
            data: { cityname: name },
            success: function (data) {
                $.each(data, function (i, item) {
                    $("#cityname").text(item.Shop_name);
                    $("#citypre").text(item.Shop_province);
                    $("#citycity").text(item.Shop_city);
                    $("#money").text(item.Shop_money);
                    $("#cityID").text(item.Shop_number);
                    $("#person").text(item.Shop_person);
                    $("#tax").text(item.Shop_pay);
                    $("#taxstate").text(item.Shop_state);
                    $("#begin").text(item.Shop_begin.substr(0, 10));
                    $("#state").text(item.State);
                    $("#cityaddress").text(item.Shop_address);
                    $("#shoptxt").text(item.Shop_txt);
                    var picname = item.Shop_pic;
                    var pics = new Array();
                    pics = picname.split(',');
                    $("#picdiv").empty();//清除之前的图片，然后加载新的图
                    for (var i = 0; i < pics.length; i++) {
                        $("#picdiv").append("<img src='/Content/images/" + pics[i] + "' style='width:12%' />");
                        //图片轮播
                        $("#first").after("<div class='t-slide'><img src='/Content/images/" + pics[i] + "' alt='' /></div>");
                    }
                });
            }
        });
    }

    function Base2() {
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: "/Index/Base2",
            data: { cityname: name },
            success: function (data) {
                if (jQuery.isEmptyObject(data) == false) {
                    $.each(data, function (i, item) {
                        $("#bossname").text(item.staff_name);
                        $("#bosssex").text(item.staff_sex);
                        $("#bossage").text(item.age);
                        $("#bossnumber").text(item.staff_number);
                        $("#bossidcard").text(item.staff_idcard);
                        $("#bossstate").text(item.staff_state);
                        $("#bosstxt").text(item.staff_txt);
                        $("#boospic").attr("src", "/Content/images/" + item.staff_pic);
                    });

                } else {//如果没有数据则显示这个
                    $("#bossname").text("没绑定");
                    $("#bosssex").text("没绑定");
                    $("#bossage").text("没绑定");
                    $("#bossnumber").text("没绑定");
                    $("#bossidcard").text("没绑定");
                    $("#bossstate").text("没绑定");
                    $("#bosstxt").text("没绑定");
                    $("#boospic").attr("src", "/Content/images/null.jpg");
                }
            }
        });
    }

    function Base4() {
        $("#trr").siblings().empty();//清除之前的表格
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: "/Index/Base4",
            data: { cityname: name },
            success: function (data) {
                $.each(data, function (i, item) {
                    $("#tablediv").append("<tr><td>" + item.staff_id + "</td><td>" + item.staff_name + "</td><td>"
                        + item.Department_name + "</td><td>" + item.staff_sex + "</td><td>" + item.staff_state + "</td><td>" + item.age + "</tr></td>");
                });
            }
        });
    }

</script>
